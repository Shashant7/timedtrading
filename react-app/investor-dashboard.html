<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
    <title>Timed Trading â€” Investor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script crossorigin src="https://unpkg.com/prop-types@15/prop-types.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="auth-gate.js"></script>
    <style>
      * { box-sizing: border-box; }
      body { margin: 0; background: #0a0a0f; color: #e5e7eb; font-family: 'Inter', system-ui, sans-serif; }
      .loading-spinner { width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.1); border-top-color: #3b82f6; border-radius: 50%; animation: spin 0.6s linear infinite; }
      @keyframes spin { to { transform: rotate(360deg); } }
      @keyframes fadeIn { from { opacity: 0; transform: translateY(4px); } to { opacity: 1; transform: translateY(0); } }
      .fade-in { animation: fadeIn 0.3s ease-out; }
      .card { background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 12px; }
      .card-hover:hover { background: rgba(255,255,255,0.04); border-color: rgba(255,255,255,0.1); }
      .stage-badge { padding: 2px 8px; border-radius: 6px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
      .stage-accumulate { background: rgba(16,185,129,0.15); color: #34d399; border: 1px solid rgba(16,185,129,0.3); }
      .stage-core_hold { background: rgba(59,130,246,0.15); color: #60a5fa; border: 1px solid rgba(59,130,246,0.3); }
      .stage-watch { background: rgba(245,158,11,0.15); color: #fbbf24; border: 1px solid rgba(245,158,11,0.3); }
      .stage-reduce { background: rgba(239,68,68,0.15); color: #f87171; border: 1px solid rgba(239,68,68,0.3); }
      .stage-research { background: rgba(139,92,246,0.15); color: #a78bfa; border: 1px solid rgba(139,92,246,0.3); }
      .stage-exited { background: rgba(107,114,128,0.15); color: #9ca3af; border: 1px solid rgba(107,114,128,0.3); }
      /* Admin-only nav links: greyed out with lock for non-admin users */
      body:not([data-user-role="admin"]) a[data-admin-only] {
        opacity: 0.35;
        pointer-events: none;
        position: relative;
      }
      body:not([data-user-role="admin"]) a[data-admin-only]::after {
        content: " ðŸ”’";
        font-size: 9px;
      }
      /* Scrollbar styling */
      ::-webkit-scrollbar { width: 4px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect, useCallback, useMemo } = React;
      const API_BASE = "";

      // â”€â”€â”€ Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function fmtPct(n) { return Number.isFinite(n) ? `${n >= 0 ? "+" : ""}${n.toFixed(1)}%` : "â€”"; }
      function fmtScore(n) { return Number.isFinite(n) ? n.toFixed(0) : "â€”"; }
      function fmtUsd(n) { return Number.isFinite(n) ? "$" + Math.abs(n).toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 }) : "$0.00"; }

      function ScoreBar({ score, max = 100, color = "#3b82f6" }) {
        const pct = Math.max(0, Math.min(100, (score / max) * 100));
        return React.createElement("div", { className: "w-full h-1.5 rounded-full bg-white/[0.06] overflow-hidden" },
          React.createElement("div", { style: { width: `${pct}%`, background: color }, className: "h-full rounded-full transition-all duration-500" })
        );
      }

      function RegimeBadge({ regime }) {
        const colors = { RISK_ON: "text-emerald-400 bg-emerald-500/10 border-emerald-500/25", CAUTIOUS: "text-amber-400 bg-amber-500/10 border-amber-500/25", RISK_OFF: "text-red-400 bg-red-500/10 border-red-500/25" };
        return React.createElement("span", { className: `px-2 py-0.5 rounded-md text-[11px] font-semibold border ${colors[regime] || colors.CAUTIOUS}` }, regime);
      }

      function StageBadge({ stage }) {
        return React.createElement("span", { className: `stage-badge stage-${stage}` }, stage.replace("_", " "));
      }

      function TrendArrow({ direction }) {
        if (direction === 1 || direction === "uptrend" || direction === "bullish") {
          return React.createElement("span", { className: "text-emerald-400", title: "Bullish" }, "â–²");
        }
        if (direction === -1 || direction === "downtrend" || direction === "bearish") {
          return React.createElement("span", { className: "text-red-400", title: "Bearish" }, "â–¼");
        }
        return React.createElement("span", { className: "text-gray-500", title: "Neutral" }, "â—");
      }

      // â”€â”€â”€ Market Health Bar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function MarketHealthBar({ health, loading }) {
        if (!health) return React.createElement("div", { className: "card p-4 mb-4" },
          React.createElement("div", { className: "text-[#6b7280] text-sm" }, loading ? "Loading market health..." : "No market health data. Click 'Compute' to generate.")
        );

        const { score, regime, breadth, components } = health;
        const color = score >= 70 ? "#10b981" : score >= 45 ? "#f59e0b" : "#ef4444";

        return React.createElement("div", { className: "card p-4 mb-4 fade-in" },
          React.createElement("div", { className: "flex items-center justify-between mb-3" },
            React.createElement("div", { className: "flex items-center gap-3" },
              React.createElement("h2", { className: "text-sm font-semibold text-white" }, "Market Health"),
              React.createElement(RegimeBadge, { regime }),
            ),
            React.createElement("div", { className: "flex items-center gap-2" },
              React.createElement("span", { className: "text-2xl font-bold", style: { color } }, score),
              React.createElement("span", { className: "text-[#6b7280] text-xs" }, "/ 100"),
            ),
          ),
          React.createElement(ScoreBar, { score, color }),
          React.createElement("div", { className: "grid grid-cols-4 gap-3 mt-3" },
            React.createElement("div", { className: "text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Breadth"),
              React.createElement("div", { className: "text-sm font-medium text-white" }, components?.breadth || 0),
            ),
            React.createElement("div", { className: "text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Regime"),
              React.createElement("div", { className: "text-sm font-medium text-white" }, components?.regimeScore || 0),
            ),
            React.createElement("div", { className: "text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Momentum"),
              React.createElement("div", { className: "text-sm font-medium text-white" }, components?.trendMomentum || 0),
            ),
            React.createElement("div", { className: "text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Above W200"),
              React.createElement("div", { className: "text-sm font-medium text-white" }, breadth?.pctAboveW200 ? `${breadth.pctAboveW200}%` : "â€”"),
            ),
          ),
        );
      }

      // â”€â”€â”€ Action Board Header with Legend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function ActionBoardHeader({ actionCount }) {
        const [showLegend, setShowLegend] = useState(false);

        return React.createElement("div", { className: "mb-2 shrink-0" },
          React.createElement("div", { className: "flex items-center justify-between" },
            React.createElement("h2", { className: "text-sm font-semibold text-white" },
              "Action Board",
              React.createElement("span", { className: "text-[10px] text-[#4b5563] ml-2 font-normal" }, `${actionCount} ticker${actionCount !== 1 ? "s" : ""} need attention`),
            ),
            React.createElement("button", {
              onClick: () => setShowLegend(!showLegend),
              className: "text-[10px] text-[#6b7280] hover:text-white transition-colors flex items-center gap-1",
            },
              React.createElement("span", null, showLegend ? "Hide" : "Legend"),
              React.createElement("svg", { width: 10, height: 10, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", style: { transform: showLegend ? "rotate(180deg)" : "none", transition: "transform 0.2s" } },
                React.createElement("polyline", { points: "6 9 12 15 18 9" }),
              ),
            ),
          ),
          showLegend && React.createElement("div", { className: "card p-3 mt-2 fade-in text-[11px] leading-relaxed" },
            // Score guide
            React.createElement("div", { className: "mb-3" },
              React.createElement("div", { className: "text-[10px] text-[#9ca3af] uppercase tracking-wide font-semibold mb-1.5" }, "Investor Score"),
              React.createElement("div", { className: "flex items-center gap-3 flex-wrap" },
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "w-2 h-2 rounded-full bg-emerald-400 inline-block" }),
                  React.createElement("span", { className: "text-emerald-400 font-semibold" }, "70-100"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "Strong â€” high conviction, trends intact"),
                ),
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "w-2 h-2 rounded-full bg-amber-400 inline-block" }),
                  React.createElement("span", { className: "text-amber-400 font-semibold" }, "50-69"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "Moderate â€” mixed signals, monitor"),
                ),
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "w-2 h-2 rounded-full bg-red-400 inline-block" }),
                  React.createElement("span", { className: "text-red-400 font-semibold" }, "0-49"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "Weak â€” caution, unfavorable setup"),
                ),
              ),
            ),
            // Lane guide
            React.createElement("div", { className: "mb-3" },
              React.createElement("div", { className: "text-[10px] text-[#9ca3af] uppercase tracking-wide font-semibold mb-1.5" }, "Action Lanes"),
              React.createElement("div", { className: "grid grid-cols-2 gap-x-4 gap-y-1.5" },
                React.createElement("div", { className: "flex items-start gap-2" },
                  React.createElement("span", { className: "stage-badge stage-accumulate !text-[9px] !py-0 shrink-0 mt-0.5" }, "Accumulate"),
                  React.createElement("span", { className: "text-[#9ca3af]" }, "In accumulation zone with favorable market health. Start or add to position via DCA. Don't go all-in â€” scale in over weeks."),
                ),
                React.createElement("div", { className: "flex items-start gap-2" },
                  React.createElement("span", { className: "stage-badge stage-core_hold !text-[9px] !py-0 shrink-0 mt-0.5" }, "Core Hold"),
                  React.createElement("span", { className: "text-[#9ca3af]" }, "Weekly + monthly trends intact, strong RS. Hold with confidence. No action needed unless score drops below 65."),
                ),
                React.createElement("div", { className: "flex items-start gap-2" },
                  React.createElement("span", { className: "stage-badge stage-watch !text-[9px] !py-0 shrink-0 mt-0.5" }, "Watch"),
                  React.createElement("span", { className: "text-[#9ca3af]" }, "Score 50-69 or RS declining. Monitor closely â€” could improve to Accumulate or degrade to Reduce. Don't add new capital yet."),
                ),
                React.createElement("div", { className: "flex items-start gap-2" },
                  React.createElement("span", { className: "stage-badge stage-reduce !text-[9px] !py-0 shrink-0 mt-0.5" }, "Reduce"),
                  React.createElement("span", { className: "text-[#9ca3af]" }, "Score below 50, weekly trend bearish, or RS rank collapsed. Consider trimming or exiting. Protect capital."),
                ),
              ),
            ),
            // Badge/indicator guide
            React.createElement("div", null,
              React.createElement("div", { className: "text-[10px] text-[#9ca3af] uppercase tracking-wide font-semibold mb-1.5" }, "Indicators"),
              React.createElement("div", { className: "flex items-center gap-3 flex-wrap" },
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "text-[9px] text-emerald-400 bg-emerald-500/10 px-1.5 py-0.5 rounded" }, "ZONE"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "In accumulation zone (oversold + monthly trend intact)"),
                ),
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "text-[9px] text-sky-400 bg-sky-500/10 px-1.5 py-0.5 rounded" }, "RS HIGH"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "Relative strength at 3-month new high vs SPY"),
                ),
                React.createElement("span", { className: "flex items-center gap-1" },
                  React.createElement("span", { className: "text-[10px] text-[#6b7280]" }, "RS: 85"),
                  React.createElement("span", { className: "text-[#6b7280]" }, "= 85th percentile relative strength rank"),
                ),
              ),
            ),
          ),
        );
      }

      // â”€â”€â”€ Action Kanban (Accumulate / Core Hold / Watch / Reduce) â”€â”€â”€â”€â”€â”€
      function ActionKanban({ tickers, onSelect, selectedTicker }) {
        const stages = ["accumulate", "core_hold", "watch", "reduce"];
        const stageLabels = { accumulate: "Accumulate", core_hold: "Core Hold", watch: "Watch", reduce: "Reduce" };
        const stageColors = { accumulate: "#10b981", core_hold: "#3b82f6", watch: "#f59e0b", reduce: "#ef4444" };
        const stageDescriptions = { accumulate: "Good time to buy", core_hold: "Hold with confidence", watch: "Monitor closely", reduce: "Consider trimming" };

        const grouped = {};
        for (const s of stages) grouped[s] = [];
        for (const t of tickers) {
          const stage = t.stage || "research";
          if (grouped[stage]) grouped[stage].push(t);
        }

        const hasAny = stages.some(s => grouped[s].length > 0);

        return React.createElement("div", { className: "flex-1 overflow-hidden" },
          React.createElement("div", { className: "grid grid-cols-4 gap-2 h-full" },
            ...stages.map(stage =>
              React.createElement("div", { key: stage, className: "flex flex-col min-h-0" },
                React.createElement("div", { className: "flex items-center justify-between mb-2 px-1 shrink-0" },
                  React.createElement("div", { className: "flex items-center gap-1" },
                    React.createElement("span", { className: `stage-badge stage-${stage}` }, stageLabels[stage]),
                    React.createElement("span", { className: "text-[10px] text-[#4b5563]" }, `(${grouped[stage].length})`),
                  ),
                ),
                React.createElement("div", { className: "text-[10px] text-[#4b5563] mb-2 px-1 shrink-0" }, stageDescriptions[stage]),
                React.createElement("div", { className: "flex-1 overflow-y-auto space-y-1 pr-0.5", style: { minHeight: 0 } },
                  ...grouped[stage].map(t =>
                    React.createElement("div", {
                      key: t.ticker,
                      className: `card card-hover p-2 cursor-pointer transition-all ${selectedTicker === t.ticker ? "border-white/20 bg-white/[0.06]" : ""}`,
                      onClick: () => onSelect(t.ticker),
                    },
                      React.createElement("div", { className: "flex items-center justify-between" },
                        React.createElement("span", { className: "text-xs font-semibold text-white" }, t.ticker),
                        React.createElement("span", { className: `text-[11px] font-medium ${t.score >= 70 ? "text-emerald-400" : t.score >= 50 ? "text-amber-400" : "text-red-400"}` }, t.score),
                      ),
                      React.createElement("div", { className: "flex items-center justify-between mt-1" },
                        React.createElement("span", { className: "text-[10px] text-[#6b7280]" }, `RS: ${t.rsRank || "â€”"}`),
                        React.createElement("span", { className: "flex items-center gap-1" },
                          t.accumZone?.inZone && React.createElement("span", { className: "text-[9px] text-emerald-400 bg-emerald-500/10 px-1 rounded" }, "ZONE"),
                          t.rs?.rsNewHigh3m && React.createElement("span", { className: "text-[9px] text-sky-400 bg-sky-500/10 px-1 rounded" }, "RS HIGH"),
                        ),
                      ),
                      React.createElement("div", { className: "mt-1" },
                        React.createElement(ScoreBar, { score: t.score, color: stageColors[stage] }),
                      ),
                    )
                  ),
                  grouped[stage].length === 0 && React.createElement("div", { className: "text-[10px] text-[#4b5563] text-center py-6 opacity-50" }, "No tickers"),
                ),
              )
            ),
          ),
        );
      }

      // â”€â”€â”€ Ticker List (scrollable viewport, no chrome) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function TickerListViewport({ tickers, onSelect, selectedTicker, savedTickers, toggleSavedTicker }) {
        return React.createElement("div", { className: "flex-1 overflow-y-auto space-y-1 pr-0.5 min-h-0" },
          ...tickers.map(t =>
            React.createElement("div", {
              key: t.ticker,
              className: `card card-hover p-2 cursor-pointer transition-all ${selectedTicker === t.ticker ? "border-white/20 bg-white/[0.06]" : ""}`,
              onClick: () => onSelect(t.ticker),
            },
              React.createElement("div", { className: "flex items-center justify-between" },
                React.createElement("div", { className: "flex items-center gap-2 min-w-0" },
                  React.createElement("span", { className: "text-xs font-semibold text-white truncate" }, t.ticker),
                  React.createElement("span", { className: `stage-badge stage-${t.stage || "research"} !text-[8px] !py-0 !px-1` }, (t.stage || "research").replace("_", " ")),
                ),
                React.createElement("div", { className: "flex items-center gap-1.5 shrink-0" },
                  React.createElement("span", { className: `text-[11px] font-semibold tabular-nums ${t.score >= 70 ? "text-emerald-400" : t.score >= 50 ? "text-amber-400" : "text-red-400"}` }, t.score),
                  React.createElement("button", {
                    onClick: (e) => { e.stopPropagation(); toggleSavedTicker(t.ticker); },
                    className: `text-[13px] hover:scale-110 transition-transform ${savedTickers.has(t.ticker) ? "text-amber-400" : "text-[#4b5563] hover:text-amber-300"}`,
                    title: savedTickers.has(t.ticker) ? "Remove from Saved" : "Add to Saved",
                  }, savedTickers.has(t.ticker) ? "â˜…" : "â˜†"),
                ),
              ),
              React.createElement("div", { className: "flex items-center justify-between mt-0.5" },
                React.createElement("span", { className: "text-[10px] text-[#6b7280]" }, `RS: ${t.rsRank || "â€”"}`),
                React.createElement("span", { className: "flex items-center gap-1" },
                  t.accumZone?.inZone && React.createElement("span", { className: "text-[8px] text-emerald-400 bg-emerald-500/10 px-1 rounded" }, "ZONE"),
                  t.rs?.rsNewHigh3m && React.createElement("span", { className: "text-[8px] text-sky-400 bg-sky-500/10 px-1 rounded" }, "RS HIGH"),
                ),
              ),
              React.createElement("div", { className: "mt-1" },
                React.createElement(ScoreBar, { score: t.score, color: t.score >= 70 ? "#10b981" : t.score >= 50 ? "#f59e0b" : "#ef4444" }),
              ),
            )
          ),
          tickers.length === 0 && React.createElement("div", { className: "text-[11px] text-[#4b5563] text-center py-8" }, "No matching tickers"),
        );
      }

      // â”€â”€â”€ Portfolio Section â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function PortfolioSection({ portfolio }) {
        if (!portfolio || !portfolio.positionHealth?.length) {
          return React.createElement("div", { className: "card p-4 mb-4" },
            React.createElement("div", { className: "text-[#6b7280] text-sm" }, "No portfolio data. Fetch investor portfolio to see analytics."),
          );
        }

        const { sectorAllocation, concentrationRisk, diversificationScore, positionHealth, suggestions } = portfolio;

        return React.createElement("div", { className: "card p-4 mb-4 fade-in" },
          React.createElement("h2", { className: "text-sm font-semibold text-white mb-3" }, "Portfolio Analytics"),
          // Metrics row
          React.createElement("div", { className: "grid grid-cols-3 gap-4 mb-4" },
            React.createElement("div", { className: "card p-3 text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Diversification"),
              React.createElement("div", { className: `text-xl font-bold ${diversificationScore >= 60 ? "text-emerald-400" : diversificationScore >= 40 ? "text-amber-400" : "text-red-400"}` }, diversificationScore),
              React.createElement(ScoreBar, { score: diversificationScore, color: diversificationScore >= 60 ? "#10b981" : "#f59e0b" }),
            ),
            React.createElement("div", { className: "card p-3 text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Concentration"),
              React.createElement("div", { className: `text-xl font-bold ${concentrationRisk.rating === "GOOD" ? "text-emerald-400" : concentrationRisk.rating === "MODERATE" ? "text-amber-400" : "text-red-400"}` }, `${concentrationRisk.top3Pct}%`),
              React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, `Top 3 positions (${concentrationRisk.rating})`),
            ),
            React.createElement("div", { className: "card p-3 text-center" },
              React.createElement("div", { className: "text-[10px] text-[#6b7280] uppercase tracking-wide" }, "Sectors Held"),
              React.createElement("div", { className: "text-xl font-bold text-white" }, Object.keys(sectorAllocation).length),
              React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, "unique sectors"),
            ),
          ),
          // Sector allocation
          React.createElement("div", { className: "mb-4" },
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Sector Allocation"),
            React.createElement("div", { className: "space-y-1" },
              ...Object.entries(sectorAllocation)
                .sort((a, b) => b[1].weight - a[1].weight)
                .map(([sector, data]) =>
                  React.createElement("div", { key: sector, className: "flex items-center gap-2" },
                    React.createElement("span", { className: "text-xs text-[#9ca3af] w-28 truncate" }, sector),
                    React.createElement("div", { className: "flex-1" },
                      React.createElement(ScoreBar, { score: data.weight, color: data.weight > 30 ? "#ef4444" : "#3b82f6" }),
                    ),
                    React.createElement("span", { className: "text-xs text-white w-12 text-right" }, `${data.weight}%`),
                  )
                ),
            ),
          ),
          // Position health table
          React.createElement("div", { className: "mb-4" },
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Position Health"),
            React.createElement("div", { className: "overflow-x-auto" },
              React.createElement("table", { className: "w-full text-xs" },
                React.createElement("thead", null,
                  React.createElement("tr", { className: "text-[#6b7280] border-b border-white/[0.06]" },
                    React.createElement("th", { className: "text-left py-1.5 font-medium" }, "Ticker"),
                    React.createElement("th", { className: "text-right py-1.5 font-medium" }, "P&L"),
                    React.createElement("th", { className: "text-right py-1.5 font-medium" }, "Score"),
                    React.createElement("th", { className: "text-right py-1.5 font-medium" }, "RS Rank"),
                    React.createElement("th", { className: "text-right py-1.5 font-medium" }, "Weight"),
                    React.createElement("th", { className: "text-left py-1.5 font-medium pl-2" }, "Sector"),
                  ),
                ),
                React.createElement("tbody", null,
                  ...positionHealth.sort((a, b) => (b.investorScore || 0) - (a.investorScore || 0)).map(ph =>
                    React.createElement("tr", { key: ph.ticker, className: "border-b border-white/[0.03] hover:bg-white/[0.02]" },
                      React.createElement("td", { className: "py-1.5 font-semibold text-white" }, ph.ticker),
                      React.createElement("td", { className: `py-1.5 text-right ${ph.pnlPct >= 0 ? "text-emerald-400" : "text-red-400"}` }, fmtPct(ph.pnlPct)),
                      React.createElement("td", { className: "py-1.5 text-right text-white" }, ph.investorScore || "â€”"),
                      React.createElement("td", { className: "py-1.5 text-right text-white" }, ph.rsRank || "â€”"),
                      React.createElement("td", { className: "py-1.5 text-right text-[#9ca3af]" }, `${ph.weight}%`),
                      React.createElement("td", { className: "py-1.5 pl-2 text-[#6b7280]" }, ph.sector),
                    )
                  ),
                ),
              ),
            ),
          ),
          // Suggestions
          suggestions?.length > 0 && React.createElement("div", null,
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Rebalancing Suggestions"),
            React.createElement("div", { className: "space-y-1.5" },
              ...suggestions.map((s, i) =>
                React.createElement("div", { key: i, className: `card p-2 text-xs ${s.priority === "high" ? "border-red-500/30" : s.priority === "medium" ? "border-amber-500/30" : "border-white/[0.06]"}` },
                  React.createElement("div", { className: "flex items-center gap-2" },
                    React.createElement("span", { className: `w-1.5 h-1.5 rounded-full ${s.priority === "high" ? "bg-red-400" : s.priority === "medium" ? "bg-amber-400" : "bg-blue-400"}` }),
                    React.createElement("span", { className: "text-[#d1d5db]" }, s.message),
                  ),
                )
              ),
            ),
          ),
        );
      }

      // â”€â”€â”€ Ticker Deep Dive (Right Rail) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function TickerDeepDive({ ticker, data }) {
        if (!ticker || !data) return React.createElement("div", { className: "card p-4 text-center text-[#6b7280] text-sm" }, "Select a ticker to see details");

        return React.createElement("div", { className: "card p-4 fade-in space-y-4" },
          React.createElement("div", { className: "flex items-center justify-between" },
            React.createElement("div", null,
              React.createElement("h2", { className: "text-lg font-bold text-white" }, ticker),
              React.createElement("span", { className: "text-xs text-[#6b7280]" }, data.sector || "Unknown"),
            ),
            React.createElement("div", { className: "text-right" },
              React.createElement("div", { className: `text-2xl font-bold ${data.score >= 70 ? "text-emerald-400" : data.score >= 50 ? "text-amber-400" : "text-red-400"}` }, data.score),
              React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, "Investor Score"),
            ),
          ),
          React.createElement(ScoreBar, { score: data.score, color: data.score >= 70 ? "#10b981" : data.score >= 50 ? "#f59e0b" : "#ef4444" }),
          // Stage
          React.createElement("div", { className: "flex items-center gap-2" },
            React.createElement(StageBadge, { stage: data.stage }),
            React.createElement("span", { className: "text-[11px] text-[#6b7280]" }, data.stageReason),
          ),
          // Score components
          data.components && React.createElement("div", null,
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Score Breakdown"),
            React.createElement("div", { className: "space-y-1.5" },
              ...Object.entries(data.components).map(([k, v]) =>
                React.createElement("div", { key: k, className: "flex items-center justify-between" },
                  React.createElement("span", { className: "text-[11px] text-[#9ca3af] capitalize" }, k.replace(/([A-Z])/g, " $1")),
                  React.createElement("div", { className: "flex items-center gap-2" },
                    React.createElement("div", { className: "w-20" },
                      React.createElement(ScoreBar, { score: v, max: k === "weeklyTrend" ? 25 : k === "monthlyTrend" ? 20 : k === "relativeStrength" ? 20 : k === "accumulationSignal" ? 15 : 10, color: "#3b82f6" }),
                    ),
                    React.createElement("span", { className: "text-xs text-white w-6 text-right" }, v),
                  ),
                )
              ),
            ),
          ),
          // Relative Strength
          data.rs && React.createElement("div", null,
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Relative Strength vs SPY"),
            React.createElement("div", { className: "grid grid-cols-3 gap-2" },
              React.createElement("div", { className: "card p-2 text-center" },
                React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, "1 Month"),
                React.createElement("div", { className: `text-sm font-semibold ${data.rs.rs1m >= 0 ? "text-emerald-400" : "text-red-400"}` }, fmtPct(data.rs.rs1m)),
              ),
              React.createElement("div", { className: "card p-2 text-center" },
                React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, "3 Month"),
                React.createElement("div", { className: `text-sm font-semibold ${data.rs.rs3m >= 0 ? "text-emerald-400" : "text-red-400"}` }, fmtPct(data.rs.rs3m)),
              ),
              React.createElement("div", { className: "card p-2 text-center" },
                React.createElement("div", { className: "text-[10px] text-[#6b7280]" }, "6 Month"),
                React.createElement("div", { className: `text-sm font-semibold ${data.rs.rs6m >= 0 ? "text-emerald-400" : "text-red-400"}` }, fmtPct(data.rs.rs6m)),
              ),
            ),
            React.createElement("div", { className: "flex items-center gap-2 mt-2" },
              React.createElement("span", { className: "text-[11px] text-[#6b7280]" }, `RS Rank: ${data.rsRank}th percentile`),
              data.rs.rsNewHigh3m && React.createElement("span", { className: "text-[10px] text-sky-400 bg-sky-500/10 px-1.5 py-0.5 rounded" }, "3M NEW HIGH"),
              data.rs.rsNewHigh6m && React.createElement("span", { className: "text-[10px] text-emerald-400 bg-emerald-500/10 px-1.5 py-0.5 rounded" }, "6M NEW HIGH"),
            ),
          ),
          // Accumulation zone
          data.accumZone && React.createElement("div", null,
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Accumulation Zone"),
            data.accumZone.inZone
              ? React.createElement("div", { className: "card p-2 border-emerald-500/30" },
                  React.createElement("div", { className: "flex items-center gap-2 mb-1" },
                    React.createElement("span", { className: "w-2 h-2 rounded-full bg-emerald-400 animate-pulse" }),
                    React.createElement("span", { className: "text-xs text-emerald-400 font-semibold" }, "IN ACCUMULATION ZONE"),
                  ),
                  React.createElement("div", { className: "text-[11px] text-[#9ca3af]" }, `Confidence: ${data.accumZone.confidence}%`),
                  React.createElement("div", { className: "flex flex-wrap gap-1 mt-1" },
                    ...data.accumZone.signals.map((s, i) =>
                      React.createElement("span", { key: i, className: "text-[9px] px-1.5 py-0.5 rounded bg-white/[0.04] text-[#9ca3af]" }, s.replace(/_/g, " "))
                    ),
                  ),
                )
              : React.createElement("div", { className: "text-xs text-[#6b7280]" }, "Not in accumulation zone"),
          ),
          // Thesis
          data.thesis && React.createElement("div", null,
            React.createElement("h3", { className: "text-xs font-semibold text-[#9ca3af] mb-2 uppercase tracking-wide" }, "Investment Thesis"),
            React.createElement("div", { className: "text-xs text-[#d1d5db] mb-2" }, data.thesis),
            data.thesisInvalidation?.length > 0 && React.createElement("div", null,
              React.createElement("div", { className: "text-[10px] text-[#6b7280] mb-1" }, "Invalidation triggers:"),
              ...data.thesisInvalidation.map((inv, i) =>
                React.createElement("div", { key: i, className: "text-[11px] text-red-400/80 pl-2" }, `â€¢ ${inv}`)
              ),
            ),
          ),
        );
      }

      // â”€â”€â”€ Main App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      function InvestorDashboard() {
        const [scores, setScores] = useState(null);
        const [health, setHealth] = useState(null);
        const [portfolio, setPortfolio] = useState(null);
        const [acctSummary, setAcctSummary] = useState(null);
        const [selectedTicker, setSelectedTicker] = useState(null);
        const [loading, setLoading] = useState(false);
        const [lastComputed, setLastComputed] = useState(null);
        const [stageFilter, setStageFilter] = useState(null);
        const [searchQuery, setSearchQuery] = useState("");
        const [showSaved, setShowSaved] = useState(false);

        // â”€â”€ Saved Tickers (per-user, server-backed) â”€â”€
        const [savedTickers, setSavedTickers] = useState(new Set());
        const savedTickersLoadedRef = React.useRef(false);
        useEffect(() => {
          if (savedTickersLoadedRef.current) return;
          savedTickersLoadedRef.current = true;
          (async () => {
            try {
              const res = await fetch(`${API_BASE}/timed/saved`, { cache: "no-store", credentials: "include" });
              const json = await res.json();
              if (json.ok && Array.isArray(json.saved_tickers)) setSavedTickers(new Set(json.saved_tickers));
            } catch (_) {}
          })();
        }, []);

        const toggleSavedTicker = useCallback(async (ticker) => {
          const t = ticker.toUpperCase();
          setSavedTickers(prev => {
            const next = new Set(prev);
            if (next.has(t)) next.delete(t); else next.add(t);
            return next;
          });
          try {
            await fetch(`${API_BASE}/timed/saved/toggle`, { method: "POST", headers: { "Content-Type": "application/json" }, credentials: "include", body: JSON.stringify({ ticker: t }) });
          } catch (_) {}
        }, []);

        const fetchData = useCallback(async () => {
          setLoading(true);
          try {
            const [scoresResp, healthResp, portfolioResp, acctResp] = await Promise.all([
              fetch(`${API_BASE}/timed/investor/scores`).then(r => r.json()).catch(() => null),
              fetch(`${API_BASE}/timed/investor/market-health`).then(r => r.json()).catch(() => null),
              fetch(`${API_BASE}/timed/investor/portfolio`).then(r => r.json()).catch(() => null),
              fetch(`${API_BASE}/timed/account-summary?mode=investor&_t=${Date.now()}`).then(r => r.json()).catch(() => null),
            ]);
            if (scoresResp?.ok) { setScores(scoresResp); setLastComputed(scoresResp.computedAt); }
            if (healthResp?.ok) setHealth(healthResp);
            if (portfolioResp?.ok) setPortfolio(portfolioResp);
            if (acctResp?.ok) setAcctSummary(acctResp);
          } finally { setLoading(false); }
        }, []);

        useEffect(() => {
          fetchData();
          const interval = setInterval(fetchData, 60000);
          return () => clearInterval(interval);
        }, [fetchData]);

        const allTickers = useMemo(() => scores?.tickers || [], [scores]);

        const selectedData = useMemo(() => {
          if (!selectedTicker || !allTickers.length) return null;
          return allTickers.find(t => t.ticker === selectedTicker);
        }, [selectedTicker, allTickers]);

        // Stage counts
        const stageCounts = useMemo(() => {
          const counts = {};
          for (const t of allTickers) {
            const s = t.stage || "research";
            counts[s] = (counts[s] || 0) + 1;
          }
          return counts;
        }, [allTickers]);

        // Count of action tickers (non-research)
        const actionCount = useMemo(() => {
          return allTickers.filter(t => t.stage && t.stage !== "research").length;
        }, [allTickers]);

        // â”€â”€ Filtered tickers (for viewport) â”€â”€
        const filteredTickers = useMemo(() => {
          let list = allTickers;
          if (showSaved) list = list.filter(t => savedTickers.has(t.ticker));
          if (stageFilter) {
            if (stageFilter === "_zone") list = list.filter(t => t.accumZone?.inZone);
            else if (stageFilter === "_rshigh") list = list.filter(t => t.rs?.rsNewHigh3m);
            else if (stageFilter === "_strong") list = list.filter(t => t.score >= 70);
            else list = list.filter(t => (t.stage || "research") === stageFilter);
          }
          if (searchQuery.trim()) {
            const q = searchQuery.toLowerCase();
            list = list.filter(t => t.ticker.toLowerCase().includes(q));
          }
          return list;
        }, [allTickers, showSaved, savedTickers, stageFilter, searchQuery]);

        const [showFilters, setShowFilters] = useState(false);
        const activeFilterCount = (stageFilter ? 1 : 0) + (showSaved ? 1 : 0);

        return React.createElement("div", { className: "min-h-screen flex flex-col" },
          // â•â•â• Nav â•â•â•
          React.createElement("nav", { className: "sticky top-0 z-50 px-4 py-2 flex items-center justify-between border-b border-white/[0.06] shrink-0", style: { background: "rgba(10,10,15,0.95)", backdropFilter: "blur(12px)" } },
            React.createElement("div", { className: "flex items-center gap-3" },
              React.createElement("span", { className: "text-[15px] font-semibold text-white tracking-tight" }, "Timed Trading"),
              React.createElement("div", { className: "flex items-center gap-0.5" },
                React.createElement("a", { href: "index-react.html", className: "px-3 py-1 rounded-md text-[13px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] transition-all" }, "Dashboard"),
                React.createElement("a", { href: "simulation-dashboard.html", className: "px-3 py-1 rounded-md text-[13px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] transition-all" }, "Trades"),
                React.createElement("a", { href: "investor-dashboard.html", className: "px-3 py-1 rounded-md text-[13px] text-white bg-white/[0.07] font-medium" }, "Investor"),
                React.createElement("a", { href: "model-dashboard.html", className: "px-3 py-1 rounded-md text-[13px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] transition-all" }, "Model"),
                React.createElement("a", { href: "screener.html", className: "px-3 py-1 rounded-md text-[13px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] transition-all" }, "Screener"),
                React.createElement("a", { href: "ticker-management.html", "data-admin-only": "true", className: "px-3 py-1 rounded-md text-[13px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] transition-all" }, "Tickers"),
              ),
            ),
            React.createElement("div", { className: "flex items-center gap-2" },
              lastComputed && React.createElement("span", { className: "text-[10px] text-[#4b5563]" }, `Scored ${new Date(lastComputed).toLocaleTimeString()}`),
              React.createElement("button", { onClick: fetchData, className: "px-3 py-1 rounded-md text-[12px] text-[#6b7280] hover:text-white hover:bg-white/[0.04] border border-white/[0.06] transition-all" }, "Refresh"),
              loading && React.createElement("div", { className: "loading-spinner" }),
            ),
          ),

          // â•â•â• Search bar + Filters + Saved + Stats (full-width, like Dashboard) â•â•â•
          React.createElement("div", { className: "px-4 pt-3 pb-2 shrink-0" },
            React.createElement("div", { className: "flex flex-wrap items-center justify-between gap-3" },
              // Left: Search + Filters button
              React.createElement("div", { className: "flex items-center gap-2" },
                React.createElement("div", { className: "w-[300px] relative" },
                  React.createElement("svg", { className: "absolute left-3 top-1/2 pointer-events-none", style: { transform: "translateY(-50%)" }, width: 14, height: 14, viewBox: "0 0 24 24", fill: "none", stroke: "#6b7280", strokeWidth: "2.5", strokeLinecap: "round", strokeLinejoin: "round" },
                    React.createElement("circle", { cx: "11", cy: "11", r: "8" }),
                    React.createElement("line", { x1: "21", y1: "21", x2: "16.65", y2: "16.65" }),
                  ),
                  React.createElement("input", {
                    type: "text",
                    placeholder: "Search tickers or filters...",
                    value: searchQuery,
                    onChange: (e) => setSearchQuery(e.target.value),
                    className: "w-full pl-9 pr-3 py-1.5 bg-white/[0.03] border border-white/[0.08] rounded-2xl text-white text-sm placeholder-[#6b7280] focus:border-white/[0.15] focus:outline-none transition-colors",
                  }),
                ),
                // Filters toggle
                React.createElement("button", {
                  onClick: () => setShowFilters(f => !f),
                  className: `flex items-center gap-1.5 px-3 py-1.5 rounded-lg border text-xs font-semibold transition-colors whitespace-nowrap ${
                    showFilters
                      ? "bg-blue-500/20 border-blue-500/40 text-blue-300"
                      : "bg-white/[0.02] border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-[#16224a]"
                  }`,
                  title: "Show/hide filter groups",
                },
                  React.createElement("svg", { width: 13, height: 13, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round" },
                    React.createElement("line", { x1: "4", y1: "6", x2: "20", y2: "6" }),
                    React.createElement("line", { x1: "4", y1: "12", x2: "20", y2: "12" }),
                    React.createElement("line", { x1: "4", y1: "18", x2: "20", y2: "18" }),
                    React.createElement("circle", { cx: "8", cy: "6", r: "2", fill: "currentColor" }),
                    React.createElement("circle", { cx: "16", cy: "12", r: "2", fill: "currentColor" }),
                    React.createElement("circle", { cx: "10", cy: "18", r: "2", fill: "currentColor" }),
                  ),
                  `Filters ${showFilters ? "â–¾" : "â–¸"}`,
                  activeFilterCount > 0 && React.createElement("span", { className: "ml-0.5 w-4 h-4 rounded-full bg-blue-500 text-white text-[9px] flex items-center justify-center" }, activeFilterCount),
                ),
                // Saved pill
                React.createElement("button", {
                  onClick: () => { setShowSaved(!showSaved); if (!showSaved) setStageFilter(null); },
                  className: `px-3 py-1.5 rounded-lg border text-xs font-semibold transition-colors ${
                    showSaved
                      ? "bg-amber-500/20 border-amber-500/40 text-amber-300"
                      : "bg-white/[0.02] border-white/[0.06] text-[#6b7280] hover:text-amber-300 hover:bg-amber-500/10"
                  }`,
                  title: `Show only saved tickers (${savedTickers.size} saved)`,
                }, `â­ Saved${savedTickers.size > 0 ? ` (${savedTickers.size})` : ""}`),
              ),
              // Right: Stats pills
              React.createElement("div", { className: "flex gap-1.5 text-[12px] items-center flex-wrap" },
                React.createElement("div", { className: "px-2.5 py-1 rounded-full bg-white/5 border border-white/5" },
                  React.createElement("span", { className: "text-[#6b7280]" }, "Tickers "),
                  React.createElement("span", { className: "font-semibold text-white" }, allTickers.length),
                ),
                (stageCounts.accumulate || 0) > 0 && React.createElement("div", { className: "px-2.5 py-1 rounded-full bg-emerald-500/8 border border-emerald-500/15" },
                  React.createElement("span", { className: "text-emerald-400/80" }, "Accumulate "),
                  React.createElement("span", { className: "font-semibold text-emerald-400" }, stageCounts.accumulate),
                ),
                (stageCounts.watch || 0) > 0 && React.createElement("div", { className: "px-2.5 py-1 rounded-full bg-amber-500/8 border border-amber-500/15" },
                  React.createElement("span", { className: "text-amber-400/80" }, "Watch "),
                  React.createElement("span", { className: "font-semibold text-amber-400" }, stageCounts.watch),
                ),
                health && React.createElement("div", { className: "px-2.5 py-1 rounded-full bg-white/5 border border-white/5" },
                  React.createElement("span", { className: "text-[#6b7280]" }, "Health "),
                  React.createElement("span", { className: `font-semibold ${health.score >= 70 ? "text-emerald-400" : health.score >= 45 ? "text-amber-400" : "text-red-400"}` }, health.score),
                ),
              ),
            ),
            // â”€â”€ Filter groups (collapsible) â”€â”€
            showFilters && React.createElement("div", { className: "mt-2 rounded-xl border border-white/[0.06] bg-white/[0.03] p-3 fade-in" },
              React.createElement("div", { className: "text-[10px] text-[#9ca3af] uppercase tracking-wide font-semibold mb-2" }, "Stage"),
              React.createElement("div", { className: "flex flex-wrap gap-1.5 mb-3" },
                React.createElement("button", {
                  onClick: () => setStageFilter(null),
                  className: `px-2.5 py-1 rounded-lg text-[11px] font-medium transition-all border ${!stageFilter ? "bg-white/[0.1] border-white/[0.15] text-white" : "border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-white/[0.04]"}`,
                }, `All (${allTickers.length})`),
                ...["accumulate", "core_hold", "watch", "reduce", "research"].map(s =>
                  React.createElement("button", {
                    key: s,
                    onClick: () => setStageFilter(stageFilter === s ? null : s),
                    className: `px-2.5 py-1 rounded-lg text-[11px] font-medium transition-all border ${stageFilter === s ? `bg-white/[0.1] border-white/[0.15] text-white` : "border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-white/[0.04]"}`,
                  },
                    React.createElement("span", { className: `inline-block w-1.5 h-1.5 rounded-full mr-1.5 ${s === "accumulate" ? "bg-emerald-400" : s === "core_hold" ? "bg-blue-400" : s === "watch" ? "bg-amber-400" : s === "reduce" ? "bg-red-400" : "bg-purple-400"}` }),
                    `${s.replace("_", " ")} (${stageCounts[s] || 0})`,
                  )
                ),
              ),
              React.createElement("div", { className: "text-[10px] text-[#9ca3af] uppercase tracking-wide font-semibold mb-2" }, "Signals"),
              React.createElement("div", { className: "flex flex-wrap gap-1.5" },
                React.createElement("button", {
                  onClick: () => setStageFilter(stageFilter === "_zone" ? null : "_zone"),
                  className: `px-2.5 py-1 rounded-lg text-[11px] font-medium transition-all border ${stageFilter === "_zone" ? "bg-emerald-500/20 border-emerald-500/30 text-emerald-300" : "border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-white/[0.04]"}`,
                }, "In Accumulation Zone"),
                React.createElement("button", {
                  onClick: () => setStageFilter(stageFilter === "_rshigh" ? null : "_rshigh"),
                  className: `px-2.5 py-1 rounded-lg text-[11px] font-medium transition-all border ${stageFilter === "_rshigh" ? "bg-sky-500/20 border-sky-500/30 text-sky-300" : "border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-white/[0.04]"}`,
                }, "RS New High"),
                React.createElement("button", {
                  onClick: () => setStageFilter(stageFilter === "_strong" ? null : "_strong"),
                  className: `px-2.5 py-1 rounded-lg text-[11px] font-medium transition-all border ${stageFilter === "_strong" ? "bg-white/[0.1] border-white/[0.15] text-white" : "border-white/[0.06] text-[#6b7280] hover:text-white hover:bg-white/[0.04]"}`,
                }, "Score 70+"),
              ),
            ),
          ),

          // â•â•â• Market Health + Account Summary (compact row) â•â•â•
          React.createElement("div", { className: "px-4 pb-2 shrink-0 space-y-2" },
            React.createElement(MarketHealthBar, { health, loading }),
            acctSummary && React.createElement("div", { className: "card p-2.5 fade-in" },
              React.createElement("div", { className: "flex items-center justify-between flex-wrap gap-3 text-[11px]" },
                React.createElement("span", { className: "text-[#6b7280]" }, "Account ",
                  React.createElement("span", { className: "text-white font-bold tabular-nums" }, fmtUsd(acctSummary.accountValue || 0)),
                ),
                React.createElement("span", { className: "text-[#6b7280]" }, "Cash ",
                  React.createElement("span", { className: "text-white font-bold tabular-nums" }, fmtUsd(acctSummary.cash || 0)),
                ),
                React.createElement("span", { className: "text-[#6b7280]" }, "Invested ",
                  React.createElement("span", { className: "text-white font-bold tabular-nums" }, fmtUsd(acctSummary.markToMarket || 0)),
                ),
                React.createElement("span", { className: "text-[#6b7280]" }, "Unrealized ",
                  React.createElement("span", { className: `font-bold tabular-nums ${(acctSummary.unrealized || 0) >= 0 ? "text-emerald-400" : "text-red-400"}` },
                    (acctSummary.unrealized >= 0 ? "+" : "") + fmtUsd(acctSummary.unrealized || 0),
                  ),
                ),
                React.createElement("span", { className: "text-[#6b7280]" }, "Realized ",
                  React.createElement("span", { className: `font-bold tabular-nums ${(acctSummary.totalRealized || 0) >= 0 ? "text-emerald-400" : "text-red-400"}` },
                    (acctSummary.totalRealized >= 0 ? "+" : "") + fmtUsd(acctSummary.totalRealized || 0),
                  ),
                ),
              ),
            ),
          ),

          // â•â•â• 3-Panel: Viewport | Action Kanban | Detail (fixed height) â•â•â•
          React.createElement("div", { className: "flex gap-3 px-4 shrink-0", style: { height: "calc(100vh - 340px)", minHeight: "320px" } },
            // Left: Viewport (scrollable ticker list)
            React.createElement("div", { className: "w-64 flex-shrink-0 flex flex-col min-h-0" },
              React.createElement("div", { className: "text-[10px] text-[#4b5563] mb-1 px-1 shrink-0" }, `${filteredTickers.length} ticker${filteredTickers.length !== 1 ? "s" : ""}`),
              React.createElement(TickerListViewport, {
                tickers: filteredTickers,
                onSelect: setSelectedTicker,
                selectedTicker,
                savedTickers,
                toggleSavedTicker,
              }),
            ),

            // Center: Action Kanban
            React.createElement("div", { className: "flex-1 flex flex-col min-h-0 min-w-0" },
              React.createElement(ActionBoardHeader, { actionCount }),
              allTickers.length > 0
                ? React.createElement(ActionKanban, { tickers: allTickers, onSelect: setSelectedTicker, selectedTicker })
                : React.createElement("div", { className: "card p-8 text-center text-[#6b7280] flex-1" },
                    React.createElement("div", { className: "text-lg mb-2" }, "No investor data yet"),
                    React.createElement("div", { className: "text-sm" }, "Scores are computed hourly during market hours."),
                  ),
            ),

            // Right: Detail
            React.createElement("div", { className: "w-80 flex-shrink-0 overflow-y-auto min-h-0" },
              React.createElement(TickerDeepDive, { ticker: selectedTicker, data: selectedData }),
            ),
          ),

          // â•â•â• Portfolio Section (always visible below, no excess scrolling) â•â•â•
          portfolio && React.createElement("div", { className: "px-4 py-3 shrink-0" },
            React.createElement(PortfolioSection, { portfolio }),
          ),
        );
      }

      // â”€â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      const _AuthGate = window.TimedAuthGate;
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(
        _AuthGate
          ? React.createElement(_AuthGate, { apiBase: API_BASE },
              (user) => React.createElement(InvestorDashboard, { user })
            )
          : React.createElement(InvestorDashboard)
      );
    </script>
  </body>
</html>

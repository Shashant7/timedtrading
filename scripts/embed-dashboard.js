#!/usr/bin/env node
/**
 * Embeds react-app/simulation-dashboard.html into worker/dashboard-html.js
 * so the worker can serve the Trade Tracker at GET / and GET /dashboard.
 * Run before: npm run deploy:worker
 */
const fs = require("fs");
const path = require("path");

const repoRoot = path.resolve(__dirname, "..");
const src = path.join(repoRoot, "react-app", "simulation-dashboard.html");
const out = path.join(repoRoot, "worker", "dashboard-html.js");

const html = fs.readFileSync(src, "utf8");
const escaped = html
  .replace(/\\/g, "\\\\")
  .replace(/`/g, "\\`")
  .replace(/\$\{/g, "\\${");
const js = `// Generated by scripts/embed-dashboard.js - do not edit
export const DASHBOARD_HTML = \`${escaped}\`;
`;
fs.writeFileSync(out, js, "utf8");
console.log("Embedded dashboard into worker/dashboard-html.js");
